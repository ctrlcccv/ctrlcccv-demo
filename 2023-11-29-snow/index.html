<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8">
<title>jQuery - 마우스 따라 움직이는 눈 만들기 | 컨트롤 + CCCV</title>
<meta name="description" content="jQuery - 마우스 따라 움직이는 눈 만들기 | 컨트롤 + CCCV" />
<meta name="robots" content="noindex">
<link rel="shortcut icon" href="https://ctrlcccv.github.io/favicon.png">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@400;500;700&amp;display=swap" rel="stylesheet">
<script src="https://code.jquery.com/jquery-3.6.4.min.js" integrity="sha256-oP6HI9z1XaZNBrJURtCoUT5SUnxFr8s3BzRl+cbzUq8=" crossorigin="anonymous"></script>
<style>
* { margin: 0; padding: 0; font-family: 'Noto Sans KR', sans-serif; box-sizing: border-box; } 
.snow_wrap {width: 100%;height: 100vh;overflow: hidden;}
canvas {background: #141f3e;}
</style>
</head>
<body>
<div class="snow_wrap">
    <canvas id="show"></canvas>
</div>

<script>
   
   const canvas = $('#show')[0];
    const ctx = canvas.getContext('2d');

    let W = $('.snow_wrap').width();
    let H = $('.snow_wrap').height();
    let lastDeviceType = window.innerWidth < 768 ? 'mobile' : 'desktop';

    function createParticles() {
        particles = []; // 기존 파티클을 지우고 새로 시작합니다.
        const particleCount = lastDeviceType === 'mobile' ? 40 : 100;
        for (let i = 0; i < particleCount; i++) {
            particles.push(new createParticle());
        }
    }

    function setCanvasSize() {
        const currentDeviceType = window.innerWidth < 768 ? 'mobile' : 'desktop';
        if (currentDeviceType !== lastDeviceType) {
            lastDeviceType = currentDeviceType;
            createParticles();
        }
        
        // 임시 캔버스로 현재 내용을 저장
        const tempCanvas = document.createElement('canvas');
        const tempCtx = tempCanvas.getContext('2d');
        tempCanvas.width = W;
        tempCanvas.height = H;
        tempCtx.drawImage(canvas, 0, 0);

        // 캔버스 크기 재설정
        W = $('.snow_wrap').width();
        H = $('.snow_wrap').height();
        canvas.width = W;
        canvas.height = H;

        // 임시 캔버스의 내용을 원래 캔버스에 복원
        ctx.drawImage(tempCanvas, 0, 0);
    }

    let particles = [];

    function createParticle() {
        this.x = Math.random() * W;
        this.y = Math.random() * H;
        this.vx = Math.random() * 4 - 1;
        this.vy = Math.random() * 4 + 1;
        this.color = `rgba(255, 255, 255, ${Math.random()})`;
        this.radius = Math.random() * 5 + 2;
    }

    function draw() {
        ctx.clearRect(0, 0, W, H);
        particles.forEach(function(p) {
            ctx.beginPath();
            let gradient = ctx.createRadialGradient(p.x, p.y, 0, p.x, p.y, p.radius);
            gradient.addColorStop(1, p.color);
            gradient.addColorStop(1, "rgb(66, 66, 66)");
            ctx.fillStyle = gradient;
            ctx.arc(p.x, p.y, p.radius, Math.PI * 2, false);
            ctx.fill();
            p.x += p.vx;
            p.y += p.vy;
            if (p.x < -50) p.x = W + 50;
            if (p.y < -50) p.y = H + 50;
            if (p.x > W + 50) p.x = -50;
            if (p.y > H + 50) p.y = -50;
        });
    }

    $(window).resize(setCanvasSize);

    setCanvasSize(); // 처음에 캔버스 크기를 설정합니다.
    createParticles(); // 초기 파티클 생성

    setInterval(draw, 33); // 눈송이 애니메이션 시작
   
   </script>

</body>
</html>
